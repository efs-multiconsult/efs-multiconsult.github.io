<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <title>SceneLayer filter and query | Sample | ArcGIS API for JavaScript 4.18</title>
    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }

      #optionsDiv {
        width: 250px;
        padding: 0 12px 0 12px;
        background-color: white;
        padding: 10px;
      }
    </style>

    <link rel="stylesheet" href="https://js.arcgis.com/4.18/esri/themes/light/main.css" />
    <script src="https://js.arcgis.com/4.18/"></script>

    <script>
      require(["esri/identity/OAuthInfo", "esri/portal/Portal", "esri/config", "esri/portal/PortalQueryParams", "esri/identity/IdentityManager", "esri/WebScene", "esri/views/SceneView", "esri/widgets/Legend", "esri/widgets/LayerList"], function(
      	OAuthInfo,
      	Portal,
      	esriConfig,
      	PortalQueryParams,
      	esriId,
        WebScene,
        SceneView,
        Legend,
        LayerList
      ) {



      	var info = new OAuthInfo({
			// Swap this ID out with registered application ID
			appId: "uexIzIm27zMWY9XL",
			// Uncomment the next line and update if using your own portal
			portalUrl: "https://cloudgis.multiconsult.no/portal/",
			// Uncomment the next line to prevent the user's signed in state from being shared with other apps on the same domain with the same authNamespace value.
			// authNamespace: "portal_oauth_inline",
			popup: false
		});

		esriId.registerOAuthInfos([info]);


		esriId
			.checkSignInStatus(info.portalUrl + "/sharing")
			.then(function() {
				
			
			})




		esriId.getCredential(info.portalUrl + "/sharing");


		esriConfig.portalUrl = "https://cloudgis.multiconsult.no/portal/"
		

        // load web scene from ArcGIS Online
        var webScene = new WebScene({
			portalItem: {
			// autocasts as new PortalItem()
			//id: "7685f7ba6b47426ea20d6f640cf98596"
			id: "12b6feda2cae40ec87286be187554814"
			}
        });

		// create the scene view
		var view = new SceneView({
			container: "viewDiv",
			map: webScene,
			environment: {
			lighting: {
				directShadowsEnabled: true
			}
			}
		});






		webScene.when(function() {

			// function that will filter by the selected floor
			function showFloors(event) {
				// retrieve the query stored in the selected value
				var floorQuery = event.target.value;
				// update the definition expression of all layers except the wireframe layer
				webScene.layers.forEach(function(layer) {
				layer.definitionExpression = floorQuery;
				});
			}

		  	document.getElementById("floorSelect").addEventListener("change", showFloors);

			
			/*
			// function that will filter by the selected floor
			function showFloors(event) {
			// retrieve the query stored in the selected value
			var floorQuery = event.target.value;

			// update the definition expression of all layers except the wireframe layer
			webScene.layers.forEach(function(layer) {
				if (layer.title !== "Building Wireframe") {
				layer.definitionExpression = floorQuery;
				}
			});
			}






			document.getElementById("floorSelect").addEventListener("change", showFloors);

			// add a legend for the officeLayer
			var legend = new Legend({
				view: view,
				layerInfos: [
					{
					layer: officeLayer,
					title: " "
					}
				]
			});

			view.ui.add(legend, "bottom-right");

			*/

			// Add a layer list to enable and disable the building wireframe
			var layerList = new LayerList({
				view: view
			});

			view.ui.add(layerList, {
				position: "top-right"
			});
        });

        

        view.ui.add(document.getElementById("optionsDiv"), {
          position: "top-left",
          index: 0
        });
      });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
	<div id="optionsDiv" class="esri-widget">
		<div>
		  <b>Filtrer p√• etasje:</b>
		  <select id="floorSelect">
			<option value="StoreyName = 'Etasje U2'">U2</option>
			<option value="StoreyName = 'Etasje U1'">U1</option>
			<option value="StoreyName = 'Etasje 1'">1</option>
			<option value="StoreyName = 'Etasje 2'">2</option>
			<option value="StoreyName = 'Etasje 3'">3</option>
			<option value="StoreyName = 'Etasje 4'">4</option>
			<option value="StoreyName = 'Etasje 5'">5</option>
			<option value="StoreyName = 'Etasje 6'">6</option>
			<option value="StoreyName = 'Etasje 7'">7</option>
			<option value="StoreyName = 'Etasje 8'">8</option>
			<option value="StoreyName = 'Etasje 9'">9</option>
			<option value="StoreyName = 'Etasje 10'">10</option>
			<option value="StoreyName = 'Etasje 11'">11</option>
			<option value="StoreyName = 'Etasje 12'">12</option>
			<option value="StoreyName = 'Etasje 13'">13</option>
		  </select>
		</div>
	  </div>
    </div>
  </body>
</html>
